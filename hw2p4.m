syms D i1 i2 i3 i4 i5 i6 i7 i8 X

% a = [D+(1/D)+1 -D -(1/D) 0 0 0 -1;
%     -D (1/D)+(2*D)+1 -1 0 0 0 0;
%     0 -1 2+(1/D)+D -D -1 0 0;
%     -(1/D) 0 -D (2/D)+D+1 -(1/D) -1 0;
%     0 0 -1 -(1/D) (2/D)+1+D -(1/D) 0;
%     0 0 0 -1 -(1/D) (2/D)+2 -(1/D);
%     -1 0 0 0 0 -(1/D) D+2+(1/D)];
% b = [X; 0; 0; 0; 0; 0; 0];
% 
% sol = a\b;

eqn1 = D*(i1-i2)+(1/D)*(i1-i3)+(i1-i7) == X;
eqn2 = ((1/D)*i2)+(D*i2)+(i2-i3)+(D*(i2-i1)) == 0;
eqn3 = (i3-i2)+((1/D)*i3)+(i3-i5)+(D*(i3-i4)) == 0;
eqn4 = ((1/D)*(i4-i1))+(D*(i4-i3))+((1/D)*(i4-i5))+(i4-i6) == 0;
eqn5 = ((1/D)*(i5-i4))+(i5-i3)+(D*i5)+((1/D)*(i5-i6)) == 0;
eqn6 = ((1/D)*(i6-i7))+(i6-i4)+((1/D)*(i6-i5))+i6 == 0;
eqn7 = (D*i7)+(i7-i1)+((1/D)*(i7-i6))+i7 == 0;

eqns = [eqn1; eqn2; eqn3; eqn4; eqn5; eqn6; eqn7];
s = solve(eqns);
s.i5


